<div data-controller="previews">
  
  <%= form.label :main_image, "Główne zdjęcie", class: "form-label d-block mt-2" %>
  
  <% if post.main_image.attached? %>
    <%= form.file_field :main_image, direct_upload: true, data: { previews_target: "input", action: "change->previews#preview"}, accept: "image/*", class: "form-control" %>
  <% else %>
    <%= form.file_field :main_image, direct_upload: true, data: { previews_target: "input", action: "change->previews#preview"}, required: true, accept: "image/*", class: "form-control" %>
  <% end %>

  
  <% if post.main_image.attached? %>
    <p class="mt-2">Aktualne główne zdjęcie:</p>
    <%= image_tag post.main_image, data: { previews_target: "preview" }, class: "image" %>
  <% else %>
    <%= image_tag "", data: { previews_target: "preview" }, class: "image" %>
  <% end %>
</div>